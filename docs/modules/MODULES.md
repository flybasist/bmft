# –ú–æ–¥—É–ª–∏ BMFT

## –û–±–∑–æ—Ä

BMFT —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ 7 –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π, –∫–∞–∂–¥—ã–π –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ —Å–≤–æ—é —Ñ—É–Ω–∫—Ü–∏—é.

**–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
- ‚úÖ **Statistics** —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞ ‚Äî –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã
- ‚öôÔ∏è **–û—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏** –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –≤ –ë–î
- üîß –ù–µ—Ç –∫–æ–º–∞–Ω–¥ `/enable`/`/disable` ‚Äî –º–æ–¥—É–ª–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—ã

---

## 1. Statistics ‚Äî –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–°—Ç–∞—Ç—É—Å:** –í—Å–µ–≥–¥–∞ –∞–∫—Ç–∏–≤–µ–Ω

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç **–≤—Å–µ** —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ç–∞–±–ª–∏—Ü—É `messages` ‚Äî –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π.

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/statistics` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/myweek` | –í—Å–µ | –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é |
| `/chatstats` | –ê–¥–º–∏–Ω—ã | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Ç–∞ –∑–∞ –ø–µ—Ä–∏–æ–¥ |
| `/topchat` | –ê–¥–º–∏–Ω—ã | –¢–æ–ø –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

### –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

```
Telegram ‚Üí Bot ‚Üí Statistics.OnMessage()
                      ‚Üì
          messageRepo.InsertMessage(chatID, threadID, userID, content_type, ...)
                      ‚Üì
            PostgreSQL (messages)
```

**–ß—Ç–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è:**
- –¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (text, photo, sticker, voice –∏ —Ç.–¥.)
- thread_id –¥–ª—è —Ç–æ–ø–∏–∫–æ–≤
- –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ JSONB –ø–æ–ª–µ

**Event logging:**
- `/chatstats` ‚Üí `event_log` (admin_viewed_stats)
- `/topchat` ‚Üí `event_log` (admin_viewed_top_users)

---

## 2. Limiter ‚Äî –ö–æ–Ω—Ç—Ä–æ–ª—å –ª–∏–º–∏—Ç–æ–≤

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è:** –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `content_limits`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ (—Å—Ç–∏–∫–µ—Ä—ã, GIF, –≥–æ–ª–æ—Å–æ–≤—ã–µ –∏ —Ç.–¥.).

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/limiter` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/mystats` | –í—Å–µ | –í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ —Å—á—ë—Ç—á–∏–∫–∏ |
| `/getlimit` | –í—Å–µ | –¢–µ–∫—É—â–∏–µ –ª–∏–º–∏—Ç—ã —á–∞—Ç–∞ |
| `/setlimit <type> <count>` | –ê–¥–º–∏–Ω—ã | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª–∏–º–∏—Ç |
| `/setvip @user` | –ê–¥–º–∏–Ω—ã | –î–∞—Ç—å VIP (–æ–±—Ö–æ–¥ –ª–∏–º–∏—Ç–æ–≤) |
| `/removevip @user` | –ê–¥–º–∏–Ω—ã | –£–¥–∞–ª–∏—Ç—å VIP |
| `/listvips` | –ê–¥–º–∏–Ω—ã | –°–ø–∏—Å–æ–∫ VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |

### –¢–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

```
text, photo, video, animation (GIF), sticker, 
voice, video_note, audio, document
```

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
Limiter.OnMessage()
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: user –≤ chat_vips?
  ‚Üì –ù–ï–¢
–ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å content_limits –¥–ª—è (chat_id, thread_id)?
  ‚Üì –î–ê
messageRepo.GetTodayCountByType(chatID, threadID, userID, content_type)
  ‚Üì
count >= limit?
  ‚Üì –î–ê
bot.Delete(message)
bot.Send("–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –Ω–∞ {type}: {count}/{limit}")
```

**VIP –æ–±—Ö–æ–¥:**
- VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç –≤—Å–µ –ª–∏–º–∏—Ç—ã
- VIP –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–ª—è –≤—Å–µ–≥–æ —á–∞—Ç–∞ –∏–ª–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–æ–ø–∏–∫–∞

**Event logging:**
- `/setlimit` ‚Üí `event_log` (limit_updated)
- `/setvip` ‚Üí `event_log` (vip_added)
- `/removevip` ‚Üí `event_log` (vip_removed)

---

## 3. Reactions ‚Äî –ê–≤—Ç–æ—Ä–µ–∞–∫—Ü–∏–∏

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è:** –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `keyword_reactions`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –æ—Ç–≤–µ—Ç –ø—Ä–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏–∏ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞.

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/reactions` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/addreaction <keyword> <reply>` | –ê–¥–º–∏–Ω—ã | –î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é |
| `/listreactions` | –ê–¥–º–∏–Ω—ã | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–µ–∞–∫—Ü–∏–π |
| `/removereaction <id>` | –ê–¥–º–∏–Ω—ã | –£–¥–∞–ª–∏—Ç—å —Ä–µ–∞–∫—Ü–∏—é |

### –¢–∏–ø—ã —Ä–µ–∞–∫—Ü–∏–π

**–¢–µ–∫—Å—Ç–æ–≤—ã–µ:**
```
/addreaction "–ø—Ä–∏–≤–µ—Ç" "–ó–¥–∞—Ä–æ–≤–∞! üëã"
```

**–ú–µ–¥–∏–∞ (—á–µ—Ä–µ–∑ reply):**
```
# –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∏–∫–µ—Ä–æ–º/—Ñ–æ—Ç–æ/GIF –∫–æ–º–∞–Ω–¥–æ–π:
/addreaction "–∫–æ—Ç–∏–∫–∏"
```

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è —Ç–∏–ø—ã: sticker, photo, animation, video, voice, document, audio

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
Reactions.OnMessage()
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å keyword_reactions –¥–ª—è (chat_id, thread_id)?
  ‚Üì –î–ê
message.Text —Å–æ–¥–µ—Ä–∂–∏—Ç keyword (case-insensitive)?
  ‚Üì –î–ê
–ü—Ä–æ–≤–µ—Ä–∫–∞: user –≤ chat_vips?
  ‚Üì –ù–ï–¢ (VIP –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è)
bot.Reply(reaction_type, reaction_data)
```

**VIP –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è:**
- VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ —Ç—Ä–∏–≥–≥–µ—Ä—è—Ç —Ä–µ–∞–∫—Ü–∏–∏
- –ß—Ç–æ–±—ã –∞–¥–º–∏–Ω—ã –Ω–µ —Å–ø–∞–º–∏–ª–∏ —Å–ª—É—á–∞–π–Ω–æ

**Event logging:**
- `/addreaction` ‚Üí `event_log` (reaction_added)
- `/removereaction` ‚Üí `event_log` (reaction_removed)

---

## 4. Scheduler ‚Äî –ó–∞–¥–∞—á–∏ –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è:** –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `scheduled_tasks`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (cron –≤—ã—Ä–∞–∂–µ–Ω–∏—è).

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/scheduler` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/addtask <name> "<cron>" <type> <data>` | –ê–¥–º–∏–Ω—ã | –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É |
| `/listtasks` | –ê–¥–º–∏–Ω—ã | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∑–∞–¥–∞—á |
| `/deltask <id>` | –ê–¥–º–∏–Ω—ã | –£–¥–∞–ª–∏—Ç—å –∑–∞–¥–∞—á—É |
| `/runtask <id>` | –ê–¥–º–∏–Ω—ã | –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á—É –≤—Ä—É—á–Ω—É—é |

### Cron –≤—ã—Ä–∞–∂–µ–Ω–∏—è

```bash
# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
* * * * *
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îÇ
‚îÇ ‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (0-6, Sunday=0)
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ –ú–µ—Å—è—Ü (1-12)
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –î–µ–Ω—å –º–µ—Å—è—Ü–∞ (1-31)
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ß–∞—Å (0-23)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ –ú–∏–Ω—É—Ç–∞ (0-59)
```

**–ü—Ä–∏–º–µ—Ä—ã:**
```bash
"0 9 * * *"      # –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ 09:00
"0 */2 * * *"    # –ö–∞–∂–¥—ã–µ 2 —á–∞—Å–∞
"0 9 * * 1"      # –ö–∞–∂–¥—ã–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –≤ 09:00
"30 18 * * 1-5"  # –ü–Ω-–ü—Ç –≤ 18:30
```

### –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–¢–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–¥–∞—á–∏:**
```
/addtask morning "0 9 * * *" text "–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! ‚òÄÔ∏è"
```

**–ú–µ–¥–∏–∞ –∑–∞–¥–∞—á–∏ (—á–µ—Ä–µ–∑ reply):**
```
# –û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∏–∫–µ—Ä–æ–º/—Ñ–æ—Ç–æ –∫–æ–º–∞–Ω–¥–æ–π:
/addtask reminder "0 18 * * 1-5" 
```

**Scope (—á–∞—Ç/—Ç–æ–ø–∏–∫):**
- –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–ª—è —Ç–æ–≥–æ –º–µ—Å—Ç–∞, –≥–¥–µ –≤—ã–∑–≤–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞
- –í –æ—Å–Ω–æ–≤–Ω–æ–º —á–∞—Ç–µ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
- –í —Ç–æ–ø–∏–∫–µ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ç–æ–ª—å–∫–æ –≤ —ç—Ç–æ—Ç —Ç–æ–ø–∏–∫

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
Scheduler.Start()
  ‚Üì
schedulerRepo.GetActiveTasks()
  ‚Üì
–î–ª—è –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏:
  cron.AddFunc(task.CronExpr, executeTask)
  ‚Üì
–ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ cron:
  executeTask()
    ‚Üì
  bot.Send(chatID, threadID, task_type, task_data)
    ‚Üì
  schedulerRepo.UpdateLastRun(taskID, NOW())
```

**Event logging:**
- `/addtask` ‚Üí `event_log` (task_created)
- `/deltask` ‚Üí `event_log` (task_deleted)
- `/runtask` ‚Üí `event_log` (task_executed_manually)

---

## 5. TextFilter ‚Äî –§–∏–ª—å—Ç—Ä —Å–ª–æ–≤

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è:** –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `banned_words`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞.

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/textfilter` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/addban <word>` | –ê–¥–º–∏–Ω—ã | –î–æ–±–∞–≤–∏—Ç—å –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–µ —Å–ª–æ–≤–æ |
| `/listbans` | –ê–¥–º–∏–Ω—ã | –°–ø–∏—Å–æ–∫ –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã—Ö —Å–ª–æ–≤ |
| `/removeban <id>` | –ê–¥–º–∏–Ω—ã | –£–¥–∞–ª–∏—Ç—å —Å–ª–æ–≤–æ –∏–∑ —Å–ø–∏—Å–∫–∞ |

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
TextFilter.OnMessage()
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å banned_words –¥–ª—è (chat_id, thread_id)?
  ‚Üì –î–ê
–ü—Ä–æ–≤–µ—Ä–∫–∞: user –≤ chat_vips?
  ‚Üì –ù–ï–¢
message.Text —Å–æ–¥–µ—Ä–∂–∏—Ç banned_word (case-insensitive)?
  ‚Üì –î–ê
bot.Delete(message)
messageRepo.MarkAsDeleted(messageID, "banned_word")
```

**VIP –æ–±—Ö–æ–¥:**
- VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –ø–∏—Å–∞—Ç—å –∑–∞–ø—Ä–µ—â—ë–Ω–Ω—ã–µ —Å–ª–æ–≤–∞

**Event logging:**
- `/addban` ‚Üí `event_log` (banned_word_added)
- `/removeban` ‚Üí `event_log` (banned_word_removed)

---

## 6. ProfanityFilter ‚Äî –§–∏–ª—å—Ç—Ä –º–∞—Ç–∞

**–ê–∫—Ç–∏–≤–∞—Ü–∏—è:** –ù–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `profanity_settings`

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–£–¥–∞–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è —Å –º–∞—Ç–æ–º –∏–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è.

### –ö–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –î–æ—Å—Ç—É–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|--------|----------|
| `/profanityfilter` | –í—Å–µ | –°–ø—Ä–∞–≤–∫–∞ –ø–æ –º–æ–¥—É–ª—é |
| `/setprofanity <action>` | –ê–¥–º–∏–Ω—ã | –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä (delete/warn/delete_warn) |
| `/profanitystatus` | –í—Å–µ | –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∏–ª—å—Ç—Ä–∞ |
| `/removeprofanity` | –ê–¥–º–∏–Ω—ã | –û—Ç–∫–ª—é—á–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä |

### –î–µ–π—Å—Ç–≤–∏—è (actions)

- `delete` ‚Äî –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
- `warn` ‚Äî –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- `delete_warn` ‚Äî —É–¥–∞–ª–∏—Ç—å –∏ –ø—Ä–µ–¥—É–ø—Ä–µ–¥–∏—Ç—å

### –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

```
ProfanityFilter.OnMessage()
  ‚Üì
–ü—Ä–æ–≤–µ—Ä–∫–∞: –µ—Å—Ç—å profanity_settings –¥–ª—è (chat_id, thread_id)?
  ‚Üì –î–ê
–ü—Ä–æ–≤–µ—Ä–∫–∞: user –≤ chat_vips?
  ‚Üì –ù–ï–¢
message.Text —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–æ –∏–∑ profanity_dictionary?
  ‚Üì –î–ê
–î–µ–π—Å—Ç–≤–∏–µ –ø–æ profanity_settings.action:
  - delete: bot.Delete(message)
  - warn: bot.Send("–ú–∞—Ç –∑–∞–ø—Ä–µ—â—ë–Ω!")
  - delete_warn: –æ–±–∞ –¥–µ–π—Å—Ç–≤–∏—è
```

**–ì–ª–æ–±–∞–ª—å–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å:**
- `profanity_dictionary` ‚Äî –µ–¥–∏–Ω—ã–π –¥–ª—è –≤—Å–µ—Ö —á–∞—Ç–æ–≤
- –ê–¥–º–∏–Ω—ã —É–ø—Ä–∞–≤–ª—è—é—Ç —Ç–æ–ª—å–∫–æ –¥–µ–π—Å—Ç–≤–∏–µ–º, –Ω–µ —Å–ª–æ–≤–∞—Ä—ë–º

**VIP –æ–±—Ö–æ–¥:**
- VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è —Ñ–∏–ª—å—Ç—Ä–æ–º

**Event logging:**
- `/setprofanity` ‚Üí `event_log` (profanity_filter_enabled)
- `/removeprofanity` ‚Üí `event_log` (profanity_filter_disabled)

---

## 7. Maintenance ‚Äî –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** –†–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–π –ë–î –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### –ó–∞–¥–∞—á–∏

**1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ä—Ç–∏—Ü–∏–π (03:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ):**
- –°–æ–∑–¥–∞—ë—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏ `messages_YYYY_MM` –Ω–∞ 3 –º–µ—Å—è—Ü–∞ –≤–ø–µ—Ä—ë–¥
- –°–æ–∑–¥–∞—ë—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏ `event_log_YYYY_MM` –Ω–∞ 3 –º–µ—Å—è—Ü–∞ –≤–ø–µ—Ä—ë–¥

**2. –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (04:00 –µ–∂–µ–¥–Ω–µ–≤–Ω–æ):**
- –£–¥–∞–ª—è–µ—Ç –ø–∞—Ä—Ç–∏—Ü–∏–∏ —Å—Ç–∞—Ä—à–µ `DB_RETENTION_MONTHS` (default: 6)
- –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `DROP TABLE`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (.env)

```bash
DB_RETENTION_MONTHS=6  # –°—Ä–æ–∫ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
```

**–ü–æ–¥—Ä–æ–±–Ω–µ–µ:** [docs/guides/ROTATION.md](../guides/ROTATION.md)

---

## –ü–æ—Ä—è–¥–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π

```
1. Statistics.OnMessage()     ‚Üê –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ messages (–≤—Å–µ–≥–¥–∞)
    ‚Üì
2. Limiter.OnMessage()         ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–∏–º–∏—Ç—ã (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥)
    ‚Üì (–µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–µ–Ω–æ)
3. TextFilter.OnMessage()      ‚Üê –§–∏–ª—å—Ç—Ä —Å–ª–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥)
    ‚Üì (–µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–µ–Ω–æ)
4. ProfanityFilter.OnMessage() ‚Üê –§–∏–ª—å—Ç—Ä –º–∞—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥)
    ‚Üì (–µ—Å–ª–∏ –Ω–µ —É–¥–∞–ª–µ–Ω–æ)
5. Reactions.OnMessage()       ‚Üê –ê–≤—Ç–æ—Ä–µ–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥)
```

**–í–∞–∂–Ω–æ:**
- Statistics —Ä–∞–±–æ—Ç–∞–µ—Ç **–≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤—ã–º**
- –ï—Å–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ —É–¥–∞–ª–µ–Ω–æ Limiter/Filter ‚Äî –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –µ–≥–æ –Ω–µ —É–≤–∏–¥—è—Ç
- VIP –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è Limiter/Filters, –Ω–æ –ù–ï Reactions

---

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–¥—É–ª–µ–π

```
Statistics (–µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã)
    ‚Üì
    ‚îú‚îÄ‚Üí Limiter (—á–∏—Ç–∞–µ—Ç –∏–∑ messages)
    ‚îú‚îÄ‚Üí Reactions (–Ω–µ–∑–∞–≤–∏—Å–∏–º)
    ‚îú‚îÄ‚Üí Scheduler (–Ω–µ–∑–∞–≤–∏—Å–∏–º)
    ‚îú‚îÄ‚Üí TextFilter (–Ω–µ–∑–∞–≤–∏—Å–∏–º)
    ‚îî‚îÄ‚Üí ProfanityFilter (–Ω–µ–∑–∞–≤–∏—Å–∏–º)
```

**Maintenance** —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –≤ —Ñ–æ–Ω–µ.

---

**–°–º. —Ç–∞–∫–∂–µ:**
- [DATABASE.md](../architecture/DATABASE.md) ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î
- [COMMANDS_ACCESS.md](../COMMANDS_ACCESS.md) ‚Äî –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
- [QUICKSTART.md](QUICKSTART.md) ‚Äî –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
